{"ast":null,"code":"\"use client\";import{useState,useEffect,useContext}from\"react\";import axios from\"axios\";import{AuthContext}from\"../context/AuthContext\";import{API_URL}from\"../config\";import AdminTicketList from\"../components/tickets/AdminTicketList\";import{jsx as _jsx,jsxs as _jsxs}from\"react/jsx-runtime\";const AdminDashboard=()=>{const{user}=useContext(AuthContext);const[tickets,setTickets]=useState([]);const[loading,setLoading]=useState(true);const[error,setError]=useState(null);// Fetch all tickets\nuseEffect(()=>{const fetchTickets=async()=>{try{const config={headers:{Authorization:`Bearer ${user.token}`}};const res=await axios.get(`${API_URL}/api/tickets`,config);setTickets(res.data);setLoading(false);}catch(err){setError(\"Failed to fetch tickets\");setLoading(false);}};fetchTickets();},[user]);// Update ticket status\nconst updateTicketStatus=async(ticketId,status)=>{try{const config={headers:{Authorization:`Bearer ${user.token}`,\"Content-Type\":\"application/json\"}};const res=await axios.put(`${API_URL}/api/tickets/${ticketId}`,{status},config);// Update tickets in state\nsetTickets(tickets.map(ticket=>ticket._id===ticketId?{...ticket,status:res.data.status}:ticket));return true;}catch(err){return false;}};return/*#__PURE__*/_jsxs(\"div\",{className:\"container mx-auto px-4 py-8\",children:[/*#__PURE__*/_jsx(\"h1\",{className:\"mb-8 text-2xl font-bold text-gray-900 dark:text-white\",children:\"All Support Tickets\"}),loading?/*#__PURE__*/_jsx(\"div\",{className:\"flex h-40 items-center justify-center\",children:/*#__PURE__*/_jsx(\"p\",{children:\"Loading tickets...\"})}):error?/*#__PURE__*/_jsx(\"div\",{className:\"rounded-md bg-red-50 p-4 dark:bg-red-900/30\",children:/*#__PURE__*/_jsx(\"p\",{className:\"text-sm text-red-700 dark:text-red-200\",children:error})}):/*#__PURE__*/_jsx(AdminTicketList,{tickets:tickets,updateTicketStatus:updateTicketStatus})]});};export default AdminDashboard;","map":{"version":3,"names":["useState","useEffect","useContext","axios","AuthContext","API_URL","AdminTicketList","jsx","_jsx","jsxs","_jsxs","AdminDashboard","user","tickets","setTickets","loading","setLoading","error","setError","fetchTickets","config","headers","Authorization","token","res","get","data","err","updateTicketStatus","ticketId","status","put","map","ticket","_id","className","children"],"sources":["/home/muaze/mini-project/frontend/src/pages/AdminDashboard.js"],"sourcesContent":["\"use client\"\n\nimport { useState, useEffect, useContext } from \"react\"\nimport axios from \"axios\"\nimport { AuthContext } from \"../context/AuthContext\"\nimport { API_URL } from \"../config\"\nimport AdminTicketList from \"../components/tickets/AdminTicketList\"\n\nconst AdminDashboard = () => {\n  const { user } = useContext(AuthContext)\n  const [tickets, setTickets] = useState([])\n  const [loading, setLoading] = useState(true)\n  const [error, setError] = useState(null)\n\n  // Fetch all tickets\n  useEffect(() => {\n    const fetchTickets = async () => {\n      try {\n        const config = {\n          headers: {\n            Authorization: `Bearer ${user.token}`,\n          },\n        }\n\n        const res = await axios.get(`${API_URL}/api/tickets`, config)\n        setTickets(res.data)\n        setLoading(false)\n      } catch (err) {\n        setError(\"Failed to fetch tickets\")\n        setLoading(false)\n      }\n    }\n\n    fetchTickets()\n  }, [user])\n\n  // Update ticket status\n  const updateTicketStatus = async (ticketId, status) => {\n    try {\n      const config = {\n        headers: {\n          Authorization: `Bearer ${user.token}`,\n          \"Content-Type\": \"application/json\",\n        },\n      }\n\n      const res = await axios.put(`${API_URL}/api/tickets/${ticketId}`, { status }, config)\n\n      // Update tickets in state\n      setTickets(tickets.map((ticket) => (ticket._id === ticketId ? { ...ticket, status: res.data.status } : ticket)))\n\n      return true\n    } catch (err) {\n      return false\n    }\n  }\n\n  return (\n    <div className=\"container mx-auto px-4 py-8\">\n      <h1 className=\"mb-8 text-2xl font-bold text-gray-900 dark:text-white\">All Support Tickets</h1>\n\n      {loading ? (\n        <div className=\"flex h-40 items-center justify-center\">\n          <p>Loading tickets...</p>\n        </div>\n      ) : error ? (\n        <div className=\"rounded-md bg-red-50 p-4 dark:bg-red-900/30\">\n          <p className=\"text-sm text-red-700 dark:text-red-200\">{error}</p>\n        </div>\n      ) : (\n        <AdminTicketList tickets={tickets} updateTicketStatus={updateTicketStatus} />\n      )}\n    </div>\n  )\n}\n\nexport default AdminDashboard\n\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}